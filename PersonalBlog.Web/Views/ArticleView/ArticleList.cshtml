@using System.Security.Claims
@{
    ViewData["Title"] = "Статьи";
    Layout = "_Layout";
}

@if (User.Identity.IsAuthenticated)
{
    <p>Привет, @User.Identity.Name!</p>
    <p>Роли: @string.Join(", ", User.Claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value))</p>
}

<h2>Все статьи</h2>
<a class="btn btn-primary mb-2" href="/ArticleView/ArticleCreate">Добавить статью</a>
<ul id="articleList" class="list-group"></ul>

<script>
async function loadArticles() {
    const res = await fetch("/articleapi/all");
    const articles = await res.json();
    const list = document.getElementById("articleList");
    list.innerHTML = "";
    articles.forEach(a => {
        list.innerHTML += `<li class="list-group-item">
            <strong>${a.title}</strong> 
            <a class="btn btn-sm btn-primary float-right ml-1" href="/ArticleView/Edit/${a.id}">Редактировать</a>
            <a class="btn btn-sm btn-secondary float-right" href="/ArticleView/Details/${a.id}">Посмотреть</a>
        </li>`;
    });
}
loadArticles();
</script>