@{
    ViewData["Title"] = "Регистрация";
    Layout = "_Layout";
}

<h2>Регистрация</h2>
<input type="text" id="login" placeholder="Логин" class="form-control mb-2"/>
<input type="text" id="nickname" placeholder="Никнейм" class="form-control mb-2"/>
<input type="text" id="email" placeholder="Email" class="form-control mb-2"/>
<input type="password" id="password" placeholder="Пароль" class="form-control mb-2"/>
<button class="btn btn-primary" onclick="doRegister()">Зарегистрироваться</button>

<script>
async function doRegister(){
    let dto = {
        Login: document.getElementById("login").value,
        Nickname: document.getElementById("nickname").value,
        Email: document.getElementById("email").value,
        Password: document.getElementById("password").value
    };
    let res = await fetch("/userapi/register", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(dto)
    });
    if(res.ok){
        alert("Пользователь создан");
        window.location.href = "/AccountView/Login";
    } else {
        let err = await res.json();
        alert("Ошибка регистрации: " + JSON.stringify(err));
    }
}
</script>